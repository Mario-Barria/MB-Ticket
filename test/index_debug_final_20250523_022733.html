
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Debug Registro Escaneo QR</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 1rem; background: #f2f2f2; }
        h2 { color: #333; }
        #log { white-space: pre-wrap; background: #fff; padding: 1rem; border: 1px solid #ccc; margin-top: 1rem; height: 300px; overflow-y: scroll; }
    </style>
</head>
<body>
    <h2>Depuraci√≥n - Escaneo y Registro</h2>
    <button onclick="testRegistro()">Simular Escaneo</button>
    <div id="log">Esperando acciones...</div>

    <script>
        const log = document.getElementById("log");

        function agregarLog(mensaje) {
            const hora = new Date().toLocaleTimeString();
            log.textContent += `\n[${hora}] ${mensaje}`;
        }

        function guardarRegistros(registros) {
            try {
                localStorage.setItem("registros", JSON.stringify(registros));
                agregarLog("‚úÖ Registro guardado en localStorage correctamente.");
            } catch (e) {
                agregarLog("‚ùå Error al guardar en localStorage: " + e.message);
            }
        }

        function testRegistro() {
            agregarLog("üîÑ Simulando escaneo...");
            let registros = [];
            try {
                const data = localStorage.getItem("registros");
                if (data) {
                    registros = JSON.parse(data);
                    agregarLog("üì¶ Registros actuales cargados.");
                } else {
                    agregarLog("üì¶ No hay registros previos.");
                }
            } catch (e) {
                agregarLog("‚ö†Ô∏è Error al cargar registros: " + e.message);
            }

            const nuevo = {
                nombre: "Ejemplo Test",
                dni: "12345678",
                fecha: new Date().toLocaleString()
            };
            registros.push(nuevo);
            agregarLog(`‚ûï Agregando registro: ${JSON.stringify(nuevo)}`);
            guardarRegistros(registros);
        }
    </script>
</body>
</html>
